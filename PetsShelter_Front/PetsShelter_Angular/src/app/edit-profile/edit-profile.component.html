
<app-navbar></app-navbar>


<div class="app-background center ">

  <div class="row justify-content-center px-6 pt-5">

    <div class="col-lg-5 rounded " >

      <div class="p-4 text-light text-center">
        <h3>Edycja profilu</h3>
      </div>

      <div class="text-light">

        <form class="form" [formGroup]="editProfileForm" (ngSubmit)="onSubmit()">
          <label for="task-title" class="form-label m-2">Imię:</label>
          <input type="text" class="form-control" id="task-title" placeholder="" name="task-title" formControlName = "name">

          <div class="text-danger p-1" *ngIf="editProfileForm.get('name')?.hasError('required') &&
          (editProfileForm.get('name')?.dirty ||
          editProfileForm.get('name')?.touched ||
            hasSubmitted)">Imię jest wymagane</div>

            <div class="text-danger p-1" *ngIf="editProfileForm.get('name')?.hasError('maxlength') &&
          (editProfileForm.get('name')?.dirty ||
          editProfileForm.get('name')?.touched ||
            hasSubmitted)">Podane imię jest za długie</div>

          <label for="task-title" class="form-label m-2">Nazwisko:</label>
          <input type="text" class="form-control" id="task-title" placeholder="" name="task-title" formControlName = "surname" >

          <div class="text-danger p-1" *ngIf="editProfileForm.get('surname')?.hasError('required') &&
          (editProfileForm.get('surname')?.dirty ||
          editProfileForm.get('surname')?.touched ||
            hasSubmitted)">Nazwisko jest wymagane</div>

            <div class="text-danger p-1" *ngIf="editProfileForm.get('surname')?.hasError('maxlength') &&
          (editProfileForm.get('surname')?.dirty ||
          editProfileForm.get('surname')?.touched ||
            hasSubmitted)">Podane nazwisko jest za długie</div>

          <label for="task-title" class="form-label m-2">E-mail:</label>
          <input type="email" class="form-control bg-secondary text-light" id="task-title" placeholder="" name="task-title" formControlName = "email" readonly>

          <div class="text-center m-4">
            <button type="submit" class="btn btn-warning">Edytuj profil</button>
          </div>

        </form>

        <div class="border-top">
          <div class="p-3 text-center" *ngIf="!isChangingPassword">
            <button type="button" class="btn btn-info" (click)="showChangingPassword()">Zmień hasło</button>
          </div>
        </div>

<!---Changing password form-->

        <form class="form" [formGroup]="changePasswordForm" (ngSubmit)="onPasswordChange()">
          <div class="pb-5" *ngIf="isChangingPassword">

            <div class="p-4 text-light text-center">
              <h4>Zmień hasło</h4>
            </div>

            <div class="text-danger p-1" *ngIf="passwordError.email && hasSubmitted">
              Stare hasło jest nieprawidłowe!
            </div>

            <label for="task-title" class="form-label m-2">Stare Hasło:</label>
            <input type="password" class="form-control" id="task-title" placeholder="" name="task-title" formControlName = "oldPassword">

            <div class="text-danger p-1" *ngIf="changePasswordForm.get('oldPassword')?.hasError('required') &&
          (changePasswordForm.get('oldPassword')?.dirty ||
          changePasswordForm.get('oldPassword')?.touched ||
            hasSubmitted)">Stare hasło jest wymagane</div>

            <label for="task-title" class="form-label m-2">Nowe Hasło:</label>
            <input type="password" class="form-control" id="task-title" placeholder="" name="task-title" formControlName = "newPassword">

            <div class="text-danger p-1" *ngIf="changePasswordForm.get('newPassword')?.hasError('required') &&
          (changePasswordForm.get('newPassword')?.dirty ||
          changePasswordForm.get('newPassword')?.touched ||
            hasSubmitted)">Nowe hasło jest wymagane</div>

            <div class="text-danger p-1" *ngIf="changePasswordForm.get('newPassword')?.hasError('minlength') &&
          (changePasswordForm.get('newPassword')?.dirty ||
          changePasswordForm.get('newPassword')?.touched ||
            hasSubmitted)">Nowe hasło musi mieć minimalnie 6 znaków</div>

          <label for="task-title" class="form-label m-2">Powtórz nowe hasło:</label>
          <input type="password" class="form-control" id="task-title" placeholder="" name="task-title" formControlName = "confirmNewPassword">

          <div class="text-danger p-1" *ngIf="changePasswordForm.get('confirmNewPassword')?.hasError('required') &&
          (changePasswordForm.get('confirmNewPassword')?.dirty ||
          changePasswordForm.get('confirmNewPassword')?.touched ||
            hasSubmitted)">Pole nie może być puste</div>

          <div class="text-danger p-1" *ngIf="!isPasswordsSame &&
          (changePasswordForm.get('confirmNewPassword')?.dirty ||
          changePasswordForm.get('confirmNewPassword')?.touched ||
            hasSubmitted)">Hasła nie są takie same</div>


          <div class="text-center m-4">
            <button type="submit" class="btn btn-primary">Potwierdź</button>
          </div>

          </div>
        </form>


      </div>

</div>
